<!DOCTYPE html>
<html>
   <head>
      <title>CommNet Calculator</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <style>
         :root {
         --body-color: #ddd;
         --active-color: #4CAF50;
         --active-hover-color: #5CBF60;
         --background-shadow: #333;
         --text-color: #f2f2f2;
         }
         html, body {	
         margin: 0;
         padding: 0;
         height: 100%;
         background-color: #444;
         font-family: Helvetica, Arial, Verdana, sans-serif;
         }
         label {
         display: inline-block;
         width: 200px;
         }
         input {
         width: 60px;
         }
         textarea {
         width: 100%;
         max-width: 350px;
         }
         .center {
         margin: auto;
         max-width: 1000px;
         min-height: 100%;
         position: relative;
         background-color: #FFF;
         box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
         }
         .content {
         padding: 10px;
         padding-bottom: 60px;
         }
         .container {  
         display: grid;  
         grid-gap: 5px;  
         grid-template-columns: repeat(auto-fit, 350px);
         }
         .topnav {
         overflow: hidden;
         color: var(--text-color);
         background-color: var(--background-shadow);
         position: sticky;
         padding-left: 10px;
         }
         .topfoot {
         position: absolute;
         bottom: 0;
         width: 100%;
         background-color: var(--background-shadow);
         color: var(--text-color);
         text-align: center;
         padding-top: 10px;
         padding-bottom: 10px;
         }
      </style>
   </head>
   <body>
      <div class="center">
         <div class="topnav">
            <h1>CommNet Calculator</h1>
         </div>
         <div class="content">
            <br />
            <div id="v0">
               <h3>KSP DSN</h3>
               <form>
                  <label for="DSN">KSP DSN Strength:</label>
                  <select name="DSN" id="DSN">
                     <option value="2g">2G</option>
                     <option value="50g">50G</option>
                     <option value="250g" selected>250G</option>
                  </select>
               </form>
            </div>
            <br />
            <div class="container">
               <div id="v1">
                  <h3>Vessel 1</h3>
                  <form>
                     <label for="v1communotron16">Communotron 16</label>
                     <input type="number" id="v1communotron16" name="v1communotron16" value="0" min="0" max="64"><br />
                     <label for="v1communotron16s">Communotron 16-S</label>
                     <input type="number" id="v1communotron16s" name="v1communotron16s" value="0" min="0" max="64"><br />
                     <label for="v1communotronDTSM1">Communotron DTS-M1</label>
                     <input type="number" id="v1communotronDTSM1" name="v1communotronDTSM1" value="0" min="0" max="64"><br />
                     <label for="v1communotronHG55">Communotron HG-55</label>
                     <input type="number" id="v1communotronHG55" name="v1communotronHG55" value="0" min="0" max="64"><br />
                     <label for="v1communotron8888">Communotron 88-88</label>
                     <input type="number" id="v1communotron8888" name="v1communotron8888" value="0" min="0" max="64"><br />
                     <label for="v1HG5">HG-5 High Gain Antenna</label>
                     <input type="number" id="v1HG5" name="v1HG5" value="0" min="0" max="64"><br />
                     <label for="v1RA2">RA-2 Relay Antenna</label>
                     <input type="number" id="v1RA2" name="v1RA2" value="0" min="0" max="64"><br />
                     <label for="v1RA15">RA-15 Relay Antenna</label>
                     <input type="number" id="v1RA15" name="v1RA15" value="0" min="0" max="64"><br />
                     <label for="v1RA100">RA-100 Relay Antenna</label>
                     <input type="number" id="v1RA100" name="v1RA100" value="0" min="0" max="64"><br />
                  </form>
               </div>
               <div id="v2">
                  <h3>Vessel 2</h3>
                  <form>
                     <label for="v2communotron16">Communotron 16</label>
                     <input type="number" id="v2communotron16" name="v2communotron16" value="0" min="0" max="64"><br />
                     <label for="v2communotron16s">Communotron 16-S</label>
                     <input type="number" id="v2communotron16s" name="v2communotron16s" value="0" min="0" max="64"><br />
                     <label for="v2communotronDTSM1">Communotron DTS-M1</label>
                     <input type="number" id="v2communotronDTSM1" name="v2communotronDTSM1" value="0" min="0" max="64"><br />
                     <label for="v2communotronHG55">Communotron HG-55</label>
                     <input type="number" id="v2communotronHG55" name="v2communotronHG55" value="0" min="0" max="64"><br />
                     <label for="v2communotron8888">Communotron 88-88</label>
                     <input type="number" id="v2communotron8888" name="v2communotron8888" value="0" min="0" max="64"><br />
                     <label for="v2HG5">HG-5 High Gain Antenna</label>
                     <input type="number" id="v2HG5" name="v2HG5" value="0" min="0" max="64"><br />
                     <label for="v2RA2">RA-2 Relay Antenna</label>
                     <input type="number" id="v2RA2" name="v2RA2" value="0" min="0" max="64"><br />
                     <label for="v2RA15">RA-15 Relay Antenna</label>
                     <input type="number" id="v2RA15" name="v2RA15" value="0" min="0" max="64"><br />
                     <label for="v2RA100">RA-100 Relay Antenna</label>
                     <input type="number" id="v2RA100" name="v2RA100" value="0" min="0" max="64"><br />
                  </form>
               </div>
            </div>
            <br />
            <div id="submit">
               <button onclick="calcConnections()">Calculate</button> 
            </div>
            <br />
            <textarea id="report" rows="16" cols="100" readonly></textarea>
         </div>
         <div class="topfoot">
            &copy; Copyright WalkerMx <script>document.write(new Date().getFullYear())</script> All Rights Reserved.
         </div>
      </div>
   </body>
   <script>
      function calcConnections() {
      	const textarea = document.getElementById('report');
      	var vessel1t = getV1BestA() * ((getV1SumA() / getV1BestA()) ** getV1ACE());
      	var vessel2t = getV2BestA() * ((getV2SumA() / getV2BestA()) ** getV2ACE());
      	var vessel1r = getV1BestR() * ((getV1SumR() / getV1BestR()) ** getV1ACR());
      	var vessel2r = getV2BestR() * ((getV2SumR() / getV2BestR()) ** getV2ACR());
      	textarea.value = ''
      	if (getV1SumA() > 0) {
      		textarea.value += 'Vessel 1 Report' + '\n';
      		textarea.value += 'Total Antenna Power: ' + getRoundedRange(vessel1t) + '\n';
      		textarea.value += 'Total Relay Power: ' + getRoundedRange(vessel1r) + '\n';
      		textarea.value += 'Max Distance from Kerbin: ' + getRoundedRange(getConnectionRange(vessel1t, getDSN())) + '\n';
      		textarea.value += 'Max Distance from Vessel 2: ' + getRoundedRange(getConnectionRange(vessel1r, vessel2t)) + '\n\n';
      	}
      	if (getV2SumA() > 0) {
      		textarea.value += 'Vessel 2 Report' + '\n';
      		textarea.value += 'Total Antenna Power: ' + getRoundedRange(vessel2t) + '\n';
      		textarea.value += 'Total Relay Power: ' + getRoundedRange(vessel2r) + '\n';
      		textarea.value += 'Max Distance from Kerbin: ' + getRoundedRange(getConnectionRange(vessel2t, getDSN())) + '\n';
      		textarea.value += 'Max Distance from Vessel 1: ' + getRoundedRange(getConnectionRange(vessel2r, vessel1t));
      	}
      }
      
      function getV1ACE() {
      	var ACE = ((vGet("v1communotron16") * 5000)+(vGet("v1communotronDTSM1") * 1500000000)+(vGet("v1communotronHG55") * 11250000000)+(vGet("v1communotron8888") * 75000000000)+(vGet("v1HG5") * 3750000)+(vGet("v1RA2") * 1500000000)+(vGet("v1RA15") * 11250000000)+(vGet("v1RA100") * 75000000000)) / ((vGet("v1communotron16") * 5000)+(vGet("v1communotronDTSM1") * 2000000000)+(vGet("v1communotronHG55") * 15000000000)+(vGet("v1communotron8888") * 100000000000)+(vGet("v1HG5") * 5000000)+(vGet("v1RA2") * 2000000000)+(vGet("v1RA15") * 15000000000)+(vGet("v1RA100") * 100000000000));
      	if (isNaN(ACE)) {
      		return 0;
      	} else {
      		return ACE;
      	}
      }
      function getV2ACE() {
      	var ACE = ((vGet("v2communotron16") * 5000)+(vGet("v2communotronDTSM1") * 1500000000)+(vGet("v2communotronHG55") * 11250000000)+(vGet("v2communotron8888") * 75000000000)+(vGet("v2HG5") * 3750000)+(vGet("v2RA2") * 1500000000)+(vGet("v2RA15") * 11250000000)+(vGet("v2RA100") * 75000000000)) / ((vGet("v2communotron16") * 5000)+(vGet("v2communotronDTSM1") * 2000000000)+(vGet("v2communotronHG55") * 15000000000)+(vGet("v2communotron8888") * 100000000000)+(vGet("v2HG5") * 5000000)+(vGet("v2RA2") * 2000000000)+(vGet("v2RA15") * 15000000000)+(vGet("v2RA100") * 100000000000));
      	if (isNaN(ACE)) {
      		return 0;
      	} else {
      		return ACE;
      	}
      }
      function getV1ACR() {
      	var ACR = ((vGet("v1HG5") * 3750000)+(vGet("v1RA2") * 1500000000)+(vGet("v1RA15") * 11250000000)+(vGet("v1RA100") * 75000000000)) / ((vGet("v1HG5") * 5000000)+(vGet("v1RA2") * 2000000000)+(vGet("v1RA15") * 15000000000)+(vGet("v1RA100") * 100000000000));
      	if (isNaN(ACR)) {
      		return 0;
      	} else {
      		return ACR;
      	}
      }
      function getV2ACR() {
      	var ACR = ((vGet("v2HG5") * 3750000)+(vGet("v2RA2") * 1500000000)+(vGet("v2RA15") * 11250000000)+(vGet("v2RA100") * 75000000000)) / ((vGet("v2HG5") * 5000000)+(vGet("v2RA2") * 2000000000)+(vGet("v2RA15") * 15000000000)+(vGet("v2RA100") * 100000000000));
      	if (isNaN(ACR)) {
      		return 0;
      	} else {
      		return ACR;
      	}
      }
      function getV1SumA() {
      	var SumA = ((vGet("v1communotron16") * 5000)+(vGet("v1communotronDTSM1") * 2000000000)+(vGet("v1communotronHG55") * 15000000000)+(vGet("v1communotron8888") * 100000000000)+(vGet("v1HG5") * 5000000)+(vGet("v1RA2") * 2000000000)+(vGet("v1RA15") * 15000000000)+(vGet("v1RA100") * 100000000000));
      	if (SumA == 0 && (vGet("v1communotron16s") > 0)) {
      		return 5000;
      	} else {
      		return SumA;
      	}
      }
      function getV2SumA() {
      	var SumA = ((vGet("v2communotron16") * 5000)+(vGet("v2communotron16s") * 5000)+(vGet("v2communotronDTSM1") * 2000000000)+(vGet("v2communotronHG55") * 15000000000)+(vGet("v2communotron8888") * 100000000000)+(vGet("v2HG5") * 5000000)+(vGet("v2RA2") * 2000000000)+(vGet("v2RA15") * 15000000000)+(vGet("v2RA100") * 100000000000));
      	if (SumA == 0 && (vGet("v2communotron16s") > 0)) {
      		return 5000;
      	} else {
      		return SumA;
      	}
      }
      function getV1SumR() {
      	return ((vGet("v1HG5") * 5000000)+(vGet("v1RA2") * 2000000000)+(vGet("v1RA15") * 15000000000)+(vGet("v1RA100") * 100000000000));
      }
      function getV2SumR() {
      	return ((vGet("v2HG5") * 5000000)+(vGet("v2RA2") * 2000000000)+(vGet("v2RA15") * 15000000000)+(vGet("v2RA100") * 100000000000));
      }
      function getV1BestA() {
      	if (vGet("v1communotron8888") > 0) {
      		return 100000000000;
      	} else if (vGet("v1RA100") > 0) {
      		return 100000000000;
      	} else if (vGet("v1communotronHG55") > 0) {
      		return 15000000000;
      	} else if (vGet("v1RA15") > 0) {
      		return 15000000000;
      	} else if (vGet("v1communotronDTSM1") > 0) {
      		return 2000000000;
      	} else if (vGet("v1RA2") > 0) {
      		return 2000000000;
      	} else if (vGet("v1HG5") > 0) {
      		return 5000000;
      	} else if (vGet("v1communotron16s") > 0) {
      		return 5000;
      	} else if (vGet("v1communotron16") > 0) {
      		return 5000;
      	} else {
      		return 0;
      	}
      }
      function getV2BestA() {
      	if (vGet("v2communotron8888") > 0) {
      		return 100000000000;
      	} else if (vGet("v2RA100") > 0) {
      		return 100000000000;
      	} else if (vGet("v2communotronHG55") > 0) {
      		return 15000000000;
      	} else if (vGet("v2RA15") > 0) {
      		return 15000000000;
      	} else if (vGet("v2communotronDTSM1") > 0) {
      		return 2000000000;
      	} else if (vGet("v2RA2") > 0) {
      		return 2000000000;
      	} else if (vGet("v2HG5") > 0) {
      		return 5000000;
      	} else if (vGet("v2communotron16s") > 0) {
      		return 5000;
      	} else if (vGet("v2communotron16") > 0) {
      		return 5000;
      	} else {
      		return 0;
      	}
      }
      
      function getV1BestR() {
      	if (vGet("v1RA100") > 0) {
      		return 100000000000;
      	} else if (vGet("v1RA15") > 0) {
      		return 15000000000;
      	} else if (vGet("v1RA2") > 0) {
      		return 2000000000;
      	} else if (vGet("v1HG5") > 0) {
      		return 5000000;
      	} else {
      		return 0;
      	}
      }
      function getV2BestR() {
      	if (vGet("v2RA100") > 0) {
      		return 100000000000;
      	} else if (vGet("v2RA15") > 0) {
      		return 15000000000;
      	} else if (vGet("v2RA2") > 0) {
      		return 2000000000;
      	} else if (vGet("v2HG5") > 0) {
      		return 5000000;
      	} else {
      		return 0;
      	}
      }
      function vGet(val) {
      	return document.getElementById(val).value;
      }
      function getConnectionRange(v1, v2) {
      	return (v1 ** 0.5) * (v2 ** 0.5);
      }
      function getRoundedRange(val) {
      	var vLen = Math.floor(val).toString().length;
      	if (vLen >= 10) {return Math.floor(val / 1000000000).toString() + 'G'}
      	if (vLen >= 7) {return Math.floor(val / 1000000).toString() + 'M'}
      	if (vLen >= 4) {return Math.floor(val / 1000).toString() + 'k'}
      	if (vLen < 4) {return val}
      }
      function getDSN() {
      	var e = document.getElementById("DSN");
      	var dsnText = e.options[e.selectedIndex].text;
      	if (dsnText == '250G') {return 250000000000}
      	if (dsnText == '50G') {return 50000000000}
      	if (dsnText == '2G') {return 2000000000}
      	return 0;
      }
   </script>
</html>